{% extends "base.html" %} {% block content %}
<nav>
    <div class="nav-wrapper">
        <a href="#" class="brand-logo">SimpleBills</a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li><a href="#">{{ profile.nickname }}</a></li>
        </ul>
    </div>
</nav>
<div id="side-nav">
  <ul class="side-nav fixed collection with-header z-depth-1">
      <li class="collection-header">
          <h5 class="headline-sub">ACCOUNTS</h5>
      </li>
      {% for account in accounts %}
      <li><a href="/account/{{ account.accountId }}" class="collection-item"> {{ account.name }}</a></li> {% endfor %}
      <li class="collection-item account-add">
          <div class="row">
              <form action="/create_account" method="post">
                  <div class="input-field col s9">
                      <input name="account_name" id="account_name" type="text" class="validate" placeholder="Add account">
                  </div>
                  <div class="col s3">
                      <button class="waves-effect waves-light btn" type="submit" name="action">Add</button>
                  </div>
              </form>
          </div>
      </li>
  </ul>
</div>
<main>
  <div class="container">
    <div class="row">
      <div class="col s12">
        <div class="account_detail_headline">
          <h4 class="headline-main col s2"><span id="account-name">{{account_name}}<span> <a href="/account/{{account_id}}/settings"><i class="material-icons">settings</i></span></h4>
          <a class="waves-effect waves-light btn modal-trigger" href="#modal1">Add a bill</a>
        </div>

        <form action="/account/{{account_id}}/create_bill" method="post" enctype='multipart/form-data'>
          <div id="modal1" class="modal modal-fixed-footer">
                  <div class="modal-content">
                        <h4> Add a Bill </h4>
                        <div class="input-field col s12">
                          <input id="bill_desc" type="text"   name="bill_desc">
                          <label for="bill_desc">Bill Description</label>
                        </div>
                        <div class="input-field col s12">
                          <input id="bill_currency_code" type="text"   name="bill_currency_code">
                          <label for="bill_currency_code">Bill Currency</label>
                        </div>
                        <div class="input-field col s12">
                          <input id="bill_amount" type="text"   name="bill_amount">
                          <label for="bill_amount">Bill Amount</label>
                        </div>
                      <div class="col s12">
                        <h3 class="headline-sub">Tags</h3>
                          <div class="bill_tags_all">
                            {% for tag in account_tags %}
                            <div class="bill_tag">
                              <input type="checkbox" name="bill_tags" value="{{tag}}" class="filled-in" id="{{tag}}"/>
                              <label for="{{tag}}">{{tag}}</label>
                            </div>
                            {% endfor %}
                          </div>

                      </div>
                      <div class="col s12">
                        <div class="bill_date col s6">
                            <h3 class="headline-sub">Date</h3>
                            <input class="col s8"name="bill_date" type="date">
                        </div>
                        <div class="col s6">
                          <div class="file_input file-field input-field">
                              <h3 class="headline-sub">Add a file</h3>
                              <div class="btn add_file_btn">
                                <i class="material-icons">add</i>
                                <input type="file" name="filename">
                              </div>
                              <div class="file-path-wrapper">
                                <input class="file-path validate col s12" type="text">
                              </div>
                            </div>
                        </div>
                      </div>

                  </div>
                  <div class="modal-footer">
                    <button class="btn modal-action modal-close waves-effect waves-red" type="submit" name="action">Save</button>
                    <a href="" class="modal-action modal-close waves-effect waves-red btn-flat ">Cancel</a>
                  </div>
          </div>
        </form>
        <div class="card row" id="search_table">
          <div class="search_box col s12">
            <form method="get">
              <div class="input-field col s6">
                <input id="bill_amount" type="text" name="search_amount" value="{{search_amount}}">
                <label for="bill_amount">Bill Amount</label>
              </div>
              <span class="col s2">Start Date: <input name="search_start_date" type="date" value="{{search_start_date}}"></span>
              <span class="col s2">End Date: <input name="search_end_date" type="date" value="{{search_end_date}}"></span>
              <div class="col s12">
                <h3 class="headline-sub">Tags</h3>
                  <div class="bill_tags_all">
                    {% for tag in account_tags %}
                    <div class="bill_tag">
                      <input type="checkbox"  name="search_tags" value="{{tag}}" class="filled-in" id="{{tag}}"/>
                      <label for="{{tag}}">{{tag}}</label>
                    </div>
                    {% endfor %}
                  </div>
              </div>
              <div class="col s12 search_btn">
                <button class="btn waves-effect waves-light" type="submit" name="action" >Search</button>
              </div>
            </form>
          </div>
          <!-- <h4 class="headline-sub col s12"> {{bills.count}} Bills </h4> {% if bills.count > 0 %} -->
          <div class="billsgi-table col s12">
              <table class="bordered col s12">
                  <thead>
                      <tr>
                          <th data-field="id">Desc</th>
                          <th data-field="name">Amount</th>
                          <th data-field="Date">Date</th>
                          <th data-field="tags">Tags</th>
                          <th data-field="Images">Images</th>
                          <th data-field="Actions">Actions</th>
                      </tr>
                  </thead>
                  <tbody>
                      {% for bill in bills %}
                      <tr>
                          <td>{{bill.desc}}</td>
                          <td>{{bill.currency_code}} {{bill.amount}}</td>
                          <td>{{bill.date}}</td>
                          <td>{{bill.tags}}</td>
                          <td>
                            {% for img_url in bill.img_urls %}
                              <a href="{{img_url.original}}"> Image </a>
                            {% endfor %}
                          </td>
                          <td><a href="/account/{{account_id}}/{{bill.billId}}/edit_bill">Edit</a></td>
                      </tr>
                      {% endfor %}
                  </tbody>
              </table>
              <!-- {% endif %} -->
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

{% endblock %}
